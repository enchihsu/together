
<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Shopping Cart</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">bookstore</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="index.html">首頁</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">逢甲商城</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">一中商城</a>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            商品管理
          </a>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
            <li><a class="dropdown-item" href="new_product.html">新增商品</a></li>
            <li><a class="dropdown-item" href="update_product.html">修改商品</a></li>
          </ul>
        </li>
      </ul>


      <ul class="navbar-nav mb-2 mb-lg-0 d-flex">
        <li class="nav-item">
          <a class="nav-link" href="#">登入</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">註冊</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">會員中心</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="shopping_cart.html">購物車(0)</a>
        </li>
      </ul>

      <form class="d-flex">
        <input class="form-control " type="text" placeholder="商品名稱" aria-label="product name" aria-describedby="searchProduct" id="productKeyword">
        <button class="btn btn-outline-success" type="button" id="searchProduct">Search</button>
      </form>
    </div>
  </div>
</nav>

<div class="car-header">
  <div class="w">
    <div class="car-logo">
      <b>Shopping Cart</b>
    </div>
  </div>
</div>

</div>
<div class="c-container">
  <div class="w">
    <div class="cart-filter-bar">
      <em>Item(s) in Cart</em>
    </div>
    <!-- 購物車主要核心區域 -->
    <div class="cart-warp">
      <!-- 頭部全選模組 -->
      <div class="cart-thead">
        <div class="t-checkbox">
          <input type="checkbox" name="" id="" class="checkall"> Select All
        </div>
        <div class="t-goods">Product Details</div>
        <div class="t-price">Price(NT$)</div>
        <div class="t-num">Qty</div>
        <div class="t-sum">Subtotal</div>
        <div class="t-action">Operate</div>
      </div>
      <!-- 商品詳細模組 -->
      <div class="cart-item-list">
        <div class="cart-item">
          <div class="p-checkbox">
            <input type="checkbox" name="" id="" class="j-checkbox">
          </div>
          <div class="p-goods">
            <div class="p-img">
              <img src="upload/p1.jpg" alt="">
            </div>
            <div class="p-msg">軟體工程 Software Engineering</div>
          </div>
          <div class="p-price">$480</div>
          <div class="p-num">
            <div class="quantity-form">
              <a href="javascript:;" class="decrement"><button @click=”handleSub(item)”>-</button></a>
              <!-- 讓輸入框只能輸入正整數 onkeyup="value=value.replace(/^(0+)|[^\d]+/g,'')"-->
              <input type="text" class="itxt" value="1" onkeyup="value=value.replace(/^(0+)|[^\d]+/g,'')">
              <a href="javascript:;" class="increment"><button @click=”handleSub(item)”>+</button></a>
            </div>
          </div>
          <div class="p-sum">$480</div>
          <div class="p-action"><a href="javascript:;"><button @click=”handledelete(index)”> For Later </button></a></div>
          <div class="p-action"><a href="javascript:;"><button @click=”handledelete(index)”>Delete</button></a></div>
        </div>
        <div class="cart-item">
          <div class="p-checkbox">
            <input type="checkbox" name="" id="" class="j-checkbox">
          </div>
          <div class="p-goods">
            <div class="p-img">
              <img src="upload/p2.jpg" alt="">
            </div>
            <div class="p-msg">作業系統 Operating System Concepts</div>
          </div>
          <div class="p-price">$890</div>
          <div class="p-num">
            <div class="quantity-form">
              <a href="javascript:;" class="decrement"><button @click=”handleSub(item)”>-</button></a>
              <input type="text" class="itxt" value="1" onkeyup="value=value.replace(/^(0+)|[^\d]+/g,'')">
              <a href="javascript:;" class="increment"><button @click=”handleSub(item)”>+</button></a>
            </div>
          </div>
          <div class="p-sum">$890</div>
          <div class="p-action"><a href="javascript:;"><button @click=”handledelete(index)”>For Later</button></a></div>
          <div class="p-action"><a href="javascript:;"><button @click=”handledelete(index)”>Delete</button></a></div>
        </div>
        <div class="cart-item">
          <div class="p-checkbox">
            <input type="checkbox" name="" id="" class="j-checkbox">
          </div>
          <div class="p-goods">
            <div class="p-img">
              <img src="upload/p3.jpg" alt="">
            </div>
            <div class="p-msg">ARM Cortex-M0 微控制器原理與實踐</div>
          </div>
          <div class="p-price">$620</div>
          <div class="p-num">
            <div class="quantity-form">
              <a href="javascript:;" class="decrement"><button @click=”handleSub(item)”>-</button></a>
              <input type="text" class="itxt" value="1" onkeyup="value=value.replace(/^(0+)|[^\d]+/g,'')">
              <a href="javascript:;" class="increment"><button @click=”handleSub(item)”>+</button></a>
            </div>
          </div>
          <div class="p-sum">$620</div>
          <div class="p-action"><a href="javascript:;"><button @click=”handledelete(index)”>For Later</button></a></div>
          <div class="p-action"><a href="javascript:;"><button @click=”handledelete(index)”>Delete</button></a></div>
        </div>
      </div>

      <!-- 結算模組 -->
      <div class="cart-floatbar">
        <div class="select-all">
          <input type="checkbox" name="" id="" class="checkall">Select All
        </div>
        <div class="operation">
          <a href="javascript:;" class="remove-batch">Delect selected items</a>
          <a href="javascript:;" class="clear-all">Clear shopping cart</a>
        </div>
        <div class="toolbar-right">
          <div class="amount-sum">Total Item <em> 0 </em> Piece(s) </div>
          <div class="price-sum">Total Amount NT <em> $ 0 </em></div>
          <button class="btn btn-outline-success" type="button" id="Checkout_button">Checkout</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Optional JavaScript; choose one of the two! -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<!-- Option 1: Bootstrap Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>

<!-- Option 2: Separate Popper and Bootstrap JS -->
<!--
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
-->

<script>
 function addProducts(products) {
      for ( let product of products ) {
        let html = '<div class="card col-4">';
        html += '<img src="' + product.imageUrl + '" class="card-img-top" alt="' + product.name + '">';
        html += '<div class="card-body">';
        html += '<h5 class="card-title">' + product.name + '</h5>';
        html += '<p class="card-text">' + product.description + '</p>';
        html += '<a href="#" class="btn btn-primary">' + product.price + '</a>';
        html += '</div>';
        html += '</div>';
        $('#productList').append(html);
      }
    }

  $(function(){
   //1.當全選改變時
   $(".checkall").change(function(){
      //單選跟隨全選變化
      $(".j-checkbox,.checkall").prop("checked",$(this).prop("checked"));
      //單選的css變化
      if($(this).prop("checked")){
         $(".cart-item").addClass("check-cart-item");
      } else {
         $(".cart-item").removeClass("check-cart-item");
      }
      //重新整理總價
      flushSumPrice();
   })

   //2.當單選改變時
   $(".j-checkbox").change(function(){
      //全選跟隨單選變化
      if($(".j-checkbox:checked").length == $(".j-checkbox").length){
         $(".checkall").prop("checked",true);
      } else {
         $(".checkall").prop("checked",false);
      }
      //單選的css變化
      if($(this).prop("checked")){
         $(this).parents(".cart-item").addClass("check-cart-item");
      } else {
         $(this).parents(".cart-item").removeClass("check-cart-item");
      }
      //重新整理總價
      flushSumPrice();
   })

   //3.增減商品,修改價格
   //點選加號時
   $(".increment").click(function(){
      //獲得輸入框的數量
      var num = $(this).siblings(".itxt").val();
      //加一
      num++;
      that = this;
      //重新整理小計
      flushSum(that,num);
      //重新整理總價
      flushSumPrice();
   })
   //點選減號時
   $(".decrement").click(function(){
      //獲得輸入框的數量
      var num = $(this).siblings(".itxt").val();
      //如果數量大於一
      if(num > 1){
         //減一
         num--;
      }
      that = this;
      //重新整理小計
      flushSum(that,num);
      //重新整理總價
      flushSumPrice();
   })

   //4.使用者修改輸入框
   $(".itxt").change(function(){
      //獲得輸入框的數量
      var num = $(this).val();
      //判斷是否輸入有誤
      if(num == ""){
         alert("輸入有誤");
         num = 1;
         $(this).val(1);
      }
      that = this;
      //重新整理小計
      flushSum(that,num);
      //重新整理總價
      flushSumPrice();
   })

   //5.刪除商品，清空購物車
   //當點選商品後面的刪除按鈕時
   $(".p-action a").click(function(){
      //刪除當前商品
      $(this).parents(".cart-item").remove();
      //重新整理總價
      flushSumPrice();
   })
   //刪除選中的商品
   $(".remove-batch").click(function(){
      //刪除勾選的商品
      $(".j-checkbox:checked").parents(".cart-item").remove();
      //重新整理總價
      flushSumPrice();
   })
   //清空購物車
   $(".clear-all").click(function(){
      //刪除所有商品
      $(".cart-item").remove();
      //重新整理總價
      flushSumPrice();
   })

   //重新整理總計和總數量
   function flushSumPrice(){
      //總件數
      var count = 0;
      //總價錢
      var money = 0;

      //遍歷數量
      $(".itxt").each(function(i,ele){
         //如果勾選上了
         if($(this).parents(".cart-item").find(".j-checkbox").prop("checked") == true){
            //累加
            count += parseInt($(ele).val());
         }
      })
      //重新整理總數量
      $(".amount-sum em").text(count);

      //遍歷價錢
      $(".p-sum").each(function(i,ele){
         //如果勾選上了
         if($(this).parents(".cart-item").find(".j-checkbox").prop("checked") == true){
            //累加
            money += parseFloat($(ele).text().substr(1));
         }
      })
      //重新整理總價錢
      $(".price-sum em").text("$" + money.toFixed(0));
   }

   //重新整理小計
   function flushSum(that,num){
      //判斷庫存
      if(num > 999){
         alert("庫存不足");
         num = 1;
         $(that).val(1);
      }
      //重新整理商品數量
      $(that).siblings(".itxt").val(num);
      //獲得商品的價格
      var price = $(that).parents(".p-num").siblings(".p-price").text();
      //擷取字串並轉型
      price = parseFloat(price.substr(1));
      //獲得商品小計
      sum = num * price;
      //重新整理商品小計,商品小計保留兩位小數
      $(that).parents(".p-num").siblings(".p-sum").text("$"+sum.toFixed(0));
   }
})
    </script>

</body>
</html>



















